import 'package:flutter_test/flutter_test.dart';
import 'package:http/http.dart';
import 'package:http/testing.dart';
import 'package:json_test/data/model/photo.dart';
import 'package:json_test/data/source/picture_source.dart';

void main() {
  test('이미지를 잘 가져와야 한다', () async {
    // 준비
    final mockClient = MockClient((request) async {
      if (request.url.toString() ==
          'https://pixabay.com/api/?key=10711147-dc41758b93b263957026bdadb&q=apple&image_type=photo') {
        return Response(fakeData, 200);
      }
      return Response('error', 404);
    });

    final api = PhotoApi(client: mockClient);

    // 실행
    List<Photo> photos = await api.getImages('apple');

    // 검증
    expect(photos[0].previewUrl,
        'https://cdn.pixabay.com/photo/2015/02/13/00/43/apples-634572_150.jpg');
    expect(photos.length, 20);
  });
}

const fakeData = """
{"total":8794,"totalHits":500,"hits":[{"id":634572,"pageURL":"https://pixabay.com/photos/apples-fruits-red-ripe-vitamins-634572/","type":"photo","tags":"apples, fruits, red","previewURL":"https://cdn.pixabay.com/photo/2015/02/13/00/43/apples-634572_150.jpg","previewWidth":100,"previewHeight":150,"webformatURL":"https://pixabay.com/get/gee879118ce17e6de3d033adee7015a432818eeeb67497701af4ecdc6186a37828edaece1659ee1e6a188dca3e30b4acf_640.jpg","webformatWidth":427,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g1d331fe908e4c8caa60d6cd0845a155c138f5410b0b9834f2d361c8d83237783f8f7a518f55ffb5d69cc807fc713b5a134e0591e3b1986a70faa57b17603bc59_1280.jpg","imageWidth":3345,"imageHeight":5017,"imageSize":811238,"views":416772,"downloads":240518,"collections":1227,"likes":2306,"comments":180,"user_id":752536,"user":"Desertrose7","userImageURL":"https://cdn.pixabay.com/user/2016/03/14/13-25-18-933_250x250.jpg"},{"id":1868496,"pageURL":"https://pixabay.com/photos/apple-computer-desk-workspace-1868496/","type":"photo","tags":"apple, computer, desk","previewURL":"https://cdn.pixabay.com/photo/2016/11/29/08/41/apple-1868496_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g1a026a1d4daafabe2fed33a332eef25f5bd1af11837f209db851905b6347d5b54507c6edf112a6e0b3c607531085a36f4fa519c7be15d49a84c790048eedb1fe_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g71fcb03802b1abcd62537d3def16c8ef8deb505401e5d450b123587503b8467c23eb107e292ea0ce3b331253c9dd99a60886e0b052c182d9ebfa9cb8c25ed4da_1280.jpg","imageWidth":5184,"imageHeight":3456,"imageSize":2735519,"views":594471,"downloads":435942,"collections":1297,"likes":959,"comments":258,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":581131,"pageURL":"https://pixabay.com/photos/office-home-office-creative-apple-581131/","type":"photo","tags":"office, home office, creative","previewURL":"https://cdn.pixabay.com/photo/2014/12/27/15/40/office-581131_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gc74017506bc0b1364f63ca7b6a5aee5a48d878b3e9e5d26797a60c02da713926c99430accbf56918b3ca54c9541167b5_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g633163e96868a75b7794ba50db9fc0b807505f5b159ca16092544fddbaca211c53e5a0edece0a821f98f75a811ecb773f6046b6c299ee994da5d06f0e9572023_1280.jpg","imageWidth":5760,"imageHeight":3840,"imageSize":5987170,"views":319062,"downloads":181064,"collections":1924,"likes":415,"comments":80,"user_id":670330,"user":"markusspiske","userImageURL":"https://cdn.pixabay.com/user/2016/07/06/12-50-00-288_250x250.jpg"},{"id":1873078,"pageURL":"https://pixabay.com/photos/apples-orchard-apple-trees-1873078/","type":"photo","tags":"apples, orchard, apple trees","previewURL":"https://cdn.pixabay.com/photo/2016/11/30/15/23/apples-1873078_150.jpg","previewWidth":150,"previewHeight":95,"webformatURL":"https://pixabay.com/get/g210c35d6efd2f653f1fd086fb3335ef8130e3d86fb26da5db13c78d3bfd49e4ca6327235076311ac3b14836ff15f4deda4690bf6b94fb0c4e6f4361e8f631716_640.jpg","webformatWidth":640,"webformatHeight":408,"largeImageURL":"https://pixabay.com/get/g3faa7e07731e11e935b08bf030ed7d7bb2a94cd3bccacb50b89d2cf7054713f555812222875999e7a4f5dd4053437f67f02f7a1529b732fa01592464cf38fe35_1280.jpg","imageWidth":3212,"imageHeight":2051,"imageSize":2581012,"views":365188,"downloads":207673,"collections":1044,"likes":1064,"comments":153,"user_id":3890388,"user":"lumix2004","userImageURL":""},{"id":1122537,"pageURL":"https://pixabay.com/photos/apple-water-droplets-fruit-moist-1122537/","type":"photo","tags":"apple, water droplets, fruit","previewURL":"https://cdn.pixabay.com/photo/2016/01/05/13/58/apple-1122537_150.jpg","previewWidth":150,"previewHeight":95,"webformatURL":"https://pixabay.com/get/g97f476632b2b03d511aa7a57a8e18ff298ea79966d48d966f78a895f95e3747fc70eba1e0aadffca75bdb46db13fb463fbe3dc6b24fdbd17c29574998cc0dc35_640.jpg","webformatWidth":640,"webformatHeight":409,"largeImageURL":"https://pixabay.com/get/g42e4c20ee753657a04e90b0565ca35dd0f402482df00dfa8e6207a62cb97d066936c573638c63db85944098a8baf9eee5237466a3f03d43a2158c2a85df121e6_1280.jpg","imageWidth":4752,"imageHeight":3044,"imageSize":5213632,"views":272915,"downloads":157908,"collections":977,"likes":1067,"comments":170,"user_id":1445608,"user":"mploscar","userImageURL":"https://cdn.pixabay.com/user/2016/01/05/14-08-20-943_250x250.jpg"},{"id":256261,"pageURL":"https://pixabay.com/photos/apple-books-still-life-fruit-food-256261/","type":"photo","tags":"apple, books, still life","previewURL":"https://cdn.pixabay.com/photo/2014/02/01/17/28/apple-256261_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g18aae02d9ad8683fefc0b4b3c56462789837a04e631a8de1e71989e71e6041fc85fd3c11cda268d915c00976086e4b75_640.jpg","webformatWidth":640,"webformatHeight":423,"largeImageURL":"https://pixabay.com/get/g30c2c81733ba1c8a4ddcdf1ec421a687a3300ad5a0b3025c087990b8b4a9b75e43aa3b35ce18b561e7824cead7b2ca4cf4bd6dcc8ca84e50104b3ea8aed94bd0_1280.jpg","imageWidth":4928,"imageHeight":3264,"imageSize":2987083,"views":450710,"downloads":226760,"collections":895,"likes":924,"comments":234,"user_id":143740,"user":"jarmoluk","userImageURL":"https://cdn.pixabay.com/user/2019/09/18/07-14-26-24_250x250.jpg"},{"id":410324,"pageURL":"https://pixabay.com/photos/iphone-smartphone-apps-apple-inc-410324/","type":"photo","tags":"iphone, smartphone, apps","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/30/iphone-410324_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g38f6bb27c40597517cb97fd3748464aa03beee5afa6ef7c24f5a18ffc3a9b46826f1d0c8c850d1ef7366c073860e2b10_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g0538c129508cd0ded2674f9ead1a3e7d1c04cc3185ac511fbc70bd33e86b0e3acc389c1377bc6094b423cd512fac5227557eb8b87bf9f90b3dda93a0f3cdeac1_1280.jpg","imageWidth":2180,"imageHeight":1453,"imageSize":477025,"views":698101,"downloads":406423,"collections":866,"likes":779,"comments":206,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":1894723,"pageURL":"https://pixabay.com/photos/smartphone-cellphone-touchscreen-1894723/","type":"photo","tags":"smartphone, cellphone, touchscreen","previewURL":"https://cdn.pixabay.com/photo/2016/12/09/11/33/smartphone-1894723_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g65d8e7eafad3392e73f368cdbc975cfc7ae1abc393cdd7538e6bf0d074b798176674ceff486c10170f9db67ba2f3d31db833a918622ad2bf3ffbaf6dc243af14_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g73b561ad0fe511a6e7d2badc09e6035fd92a709d8e5bbc370ee6952c7e89798cff372e293fd273d3dce1c503c54a874ef9750c0a06e2236b3d78d361a5b84677_1280.jpg","imageWidth":5005,"imageHeight":3337,"imageSize":1214266,"views":449901,"downloads":290165,"collections":765,"likes":805,"comments":276,"user_id":282134,"user":"stevepb","userImageURL":"https://cdn.pixabay.com/user/2015/09/15/20-33-27-452_250x250.jpg"},{"id":1867461,"pageURL":"https://pixabay.com/photos/apple-iphone-close-up-smartphone-1867461/","type":"photo","tags":"apple, iphone, close up","previewURL":"https://cdn.pixabay.com/photo/2016/11/29/05/08/apple-1867461_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/g6cb6de298463ae0aac1ede883db03f706c75c999df1f0c694452cc98c78770ed3c2825e81f4c4bd09c54eba85c29472a6bb4c517a0963a1e4e47104852ffd6f9_640.jpg","webformatWidth":640,"webformatHeight":427,"largeImageURL":"https://pixabay.com/get/g4dd69e3551cba312182593d707da0ecc74030284dd37d216d9a9d2997b8b509c0ce66c397de7714eb45f564ceb6bde75426181916a37541dcfe37aa3d4f6d7be_1280.jpg","imageWidth":5252,"imageHeight":3507,"imageSize":1410507,"views":70813,"downloads":42166,"collections":1529,"likes":133,"comments":20,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":1368187,"pageURL":"https://pixabay.com/photos/apple-blossom-flowers-tree-1368187/","type":"photo","tags":"apple blossom, flowers, tree","previewURL":"https://cdn.pixabay.com/photo/2016/05/02/22/16/apple-blossom-1368187_150.jpg","previewWidth":150,"previewHeight":88,"webformatURL":"https://pixabay.com/get/gd82ff01ad6583bc7ed793ef0465c257e7605defa08f731d7fe330e89f7e4245eda7f874cf28ab90f2028c8e64e47e9f699a25edf00261b0648d8f7a6c42481a9_640.jpg","webformatWidth":640,"webformatHeight":379,"largeImageURL":"https://pixabay.com/get/gc6ecfdf9c533b18348e2352e3edaef5f7a4fa62b856f1c075b48e34869dc9c0fb9a9b69734aee56da5cbd3116f09e1f239fdadb5bceba0342e2f6aabf362b0f6_1280.jpg","imageWidth":3966,"imageHeight":2352,"imageSize":860935,"views":199131,"downloads":120310,"collections":585,"likes":690,"comments":117,"user_id":2367988,"user":"kie-ker","userImageURL":""},{"id":410311,"pageURL":"https://pixabay.com/photos/iphone-hand-screen-smartphone-apps-410311/","type":"photo","tags":"iphone, hand, screen","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/27/iphone-410311_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gfa316e04d15f20fc68a1bda4c01bf5fe79e9833907840aa28633db957afb5a5e7fac8bf93090c054d219d04a537c017a_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gf5fed6e6a7728bf133bc30539782bd19d4f4976906713d5fb9ef323bf0cf1ff027d9e71f839e1982f0c9f02135aa9f8977263957cf70d400a124723cbcff0327_1280.jpg","imageWidth":1920,"imageHeight":1280,"imageSize":416413,"views":509578,"downloads":253121,"collections":624,"likes":594,"comments":161,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":500291,"pageURL":"https://pixabay.com/photos/iphone-hand-girl-smartphone-500291/","type":"photo","tags":"iphone, hand, girl","previewURL":"https://cdn.pixabay.com/photo/2014/10/23/20/51/iphone-500291_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gb0dc47c22fae69e4a32460776e1ae2dc072f072628fe7043c195ab5b41121e3ca68ca4ab4a739a11f2b5fae9cb9fd8c6_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g35af280ae88363eae13e177b5b1a82c1eb088aa366fcfd0343235e6610dc4f54db7357c58c197c873fb6cdc1504616e686e4bab7dacb9378b22d9f89d5c59d9f_1280.jpg","imageWidth":1920,"imageHeight":1280,"imageSize":521447,"views":155761,"downloads":75975,"collections":1039,"likes":250,"comments":45,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":3723444,"pageURL":"https://pixabay.com/photos/woman-apple-pie-pastries-dessert-3723444/","type":"photo","tags":"woman, apple pie, pastries","previewURL":"https://cdn.pixabay.com/photo/2018/10/04/11/37/woman-3723444_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g23c80adc6fbd0703e799c1dfa47fcd0ad5fbb45b88cb61fa4b47ecb96bbbb5fd4de08da85a3c904d369c5e54d2d53bf1117267a0d6a59ea9f1df54ced3379e9d_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gd2ae3a0d0b0ae8cd23ed5254cb307bff4e208503d7b61dfe2586d84a9b99b102c962a85ad8ab5e90b6eda0b822e00024f3ada170b3e8f9189a2e2714f3854644_1280.jpg","imageWidth":4896,"imageHeight":3264,"imageSize":3912257,"views":49909,"downloads":28272,"collections":1117,"likes":157,"comments":43,"user_id":4512347,"user":"Finn-b","userImageURL":"https://cdn.pixabay.com/user/2018/10/04/11-59-47-505_250x250.jpg"},{"id":1702316,"pageURL":"https://pixabay.com/photos/apple-red-fruit-red-chief-1702316/","type":"photo","tags":"apple, red, fruit","previewURL":"https://cdn.pixabay.com/photo/2016/09/29/08/33/apple-1702316_150.jpg","previewWidth":150,"previewHeight":116,"webformatURL":"https://pixabay.com/get/gdcba9c26063fc3b0d28c212362ca192cdc6d9b25b73fe4a2188f6214b33a7abfda20b2a8b6a09f27ec65fc0dcac8ae80bcf7d1066454e541a3753dd3c0976e29_640.jpg","webformatWidth":640,"webformatHeight":495,"largeImageURL":"https://pixabay.com/get/gc9b478c73ddf2eba6fdcaad1a2e475efa1d119804857660496f4d45abb7a82e6178297da0da596c730431e004c88d2ae6d11ac2a072724b6f0b56e03b33e2725_1280.jpg","imageWidth":4000,"imageHeight":3099,"imageSize":1930833,"views":108344,"downloads":70567,"collections":883,"likes":355,"comments":32,"user_id":2364555,"user":"pixel2013","userImageURL":"https://cdn.pixabay.com/user/2020/07/25/21-10-11-80_250x250.jpg"},{"id":606761,"pageURL":"https://pixabay.com/photos/apple-imac-ipad-workplace-606761/","type":"photo","tags":"apple, imac, ipad","previewURL":"https://cdn.pixabay.com/photo/2015/01/21/14/14/apple-606761_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gcfc701d94bf548b423bbdd2421ce02d236a02f645b3ee684265c16ff3d2b09a896c56e95762a54f8d5f91808941c2668_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/g0976695698e4432b6c38270c38bd357cae6699e183ebe7f8281ef1350e0f6840ec4e202791a1b29dedc03ec3d882b54e70854ab7646b08f981056e2f2a671c4d_1280.jpg","imageWidth":4209,"imageHeight":2796,"imageSize":1649126,"views":383478,"downloads":209777,"collections":645,"likes":487,"comments":111,"user_id":663163,"user":"Firmbee","userImageURL":"https://cdn.pixabay.com/user/2020/11/25/09-38-28-431_250x250.png"},{"id":1776744,"pageURL":"https://pixabay.com/photos/apples-leaves-fall-still-life-1776744/","type":"photo","tags":"apples, leaves, fall","previewURL":"https://cdn.pixabay.com/photo/2016/10/27/22/52/apples-1776744_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/g387951f3b0797eadeb03447aacd7ef8f6911ae705a406d51b4e6b7eb7f0e292872c5d138cd2dc18305995f67a7398abdcab062d53a05a6b5908d75699ae01846_640.jpg","webformatWidth":640,"webformatHeight":427,"largeImageURL":"https://pixabay.com/get/gb85cc42fe3e9062fdcec37166fa865a9a270a3c3013999635759038736874769fb51eebbdb4ee518f965c5ed96eda62a2dd44f40e96c6ff53945736a5f476681_1280.jpg","imageWidth":4193,"imageHeight":2798,"imageSize":2002268,"views":162500,"downloads":99992,"collections":601,"likes":573,"comments":78,"user_id":2970404,"user":"castleguard","userImageURL":"https://cdn.pixabay.com/user/2016/09/18/22-38-35-578_250x250.jpg"},{"id":2788662,"pageURL":"https://pixabay.com/photos/apple-red-hand-apple-plantation-2788662/","type":"photo","tags":"apple, red, hand","previewURL":"https://cdn.pixabay.com/photo/2017/09/26/13/42/apple-2788662_150.jpg","previewWidth":150,"previewHeight":88,"webformatURL":"https://pixabay.com/get/g567d9c52005b8b71b8e4855e7d4c6b6abdb32856da5dc0bf2e3d4c9e73b42d913627c297feab42c4f9bcbe75544bbd5ce19f0fa5cbeaebbfb708141e0719842b_640.jpg","webformatWidth":640,"webformatHeight":377,"largeImageURL":"https://pixabay.com/get/g508f34a57533ef8c6e3306beda59e1719fb2874a2b3dbe23c128ae8ed5bef85835a2a4b89b9581736919b6187396759a7270ceee208e809ae97541654abe6cc1_1280.jpg","imageWidth":6000,"imageHeight":3539,"imageSize":2042422,"views":140063,"downloads":81051,"collections":559,"likes":588,"comments":86,"user_id":2364555,"user":"pixel2013","userImageURL":"https://cdn.pixabay.com/user/2020/07/25/21-10-11-80_250x250.jpg"},{"id":1872997,"pageURL":"https://pixabay.com/photos/apples-fruits-orchard-nature-trees-1872997/","type":"photo","tags":"apples, fruits, orchard","previewURL":"https://cdn.pixabay.com/photo/2016/11/30/15/00/apples-1872997_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g4af40bf13b0ee99f3eb6c4a6b1144b65f8f9db29100969a3c8bc75aa01eb0e76cc549312a2dcc233be3867e17702c9cd161ea80888cc3bbd9ac973ca36e5ab66_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gc7e7dd1c0728da2c77d51a60c16429141f191bce6206079e11c42a3cbfbd69b86c7206148d89e2aaf3e78b96537f9ea58b6f9752d1b8ee64cac5e2449704b400_1280.jpg","imageWidth":3504,"imageHeight":2336,"imageSize":2019234,"views":175873,"downloads":108400,"collections":574,"likes":598,"comments":84,"user_id":3890388,"user":"lumix2004","userImageURL":""},{"id":569153,"pageURL":"https://pixabay.com/photos/home-office-notebook-home-couch-569153/","type":"photo","tags":"home office, notebook, home","previewURL":"https://cdn.pixabay.com/photo/2014/12/15/14/05/home-office-569153_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g1bcc39e2f37e677ec9f8df20852c24a89aece0ae65f30504c2d00db9e64be306ec028134de8c4ef9dc7ed0ee9f57497d_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gdb850735c014a276524169e1cd34b0ec80d786d3a6211596867a7047e525286bf362fbc51178c9b3c99d28382fadaf6d018aeafeb03b290af1b3e31f870b9eb0_1280.jpg","imageWidth":5760,"imageHeight":3840,"imageSize":3991496,"views":301930,"downloads":155177,"collections":654,"likes":458,"comments":88,"user_id":364018,"user":"Life-Of-Pix","userImageURL":"https://cdn.pixabay.com/user/2014/08/21/23-01-42-554_250x250.jpg"},{"id":2838921,"pageURL":"https://pixabay.com/photos/laptop-mockup-graphics-tablet-2838921/","type":"photo","tags":"laptop, mockup, graphics tablet","previewURL":"https://cdn.pixabay.com/photo/2017/10/10/21/47/laptop-2838921_150.jpg","previewWidth":150,"previewHeight":89,"webformatURL":"https://pixabay.com/get/g73f464475f98b776807bddc6c0d376539ee24b8d91c7a0a761d7605e318f2c66e4ed8fba3e3604445e3f9504e91d63d121b1e5159a1cb026f4eb54ace09dc382_640.jpg","webformatWidth":640,"webformatHeight":380,"largeImageURL":"https://pixabay.com/get/g9a2672319cb9ba2dc9dc07dc5829f0b5122aefc87a1c1d819d635e58dcac56c605ba4467f9e08aeaec2ea4efa2ab6ea03d1f09470efe21fefb824fb3e01eeee6_1280.jpg","imageWidth":5472,"imageHeight":3252,"imageSize":5820165,"views":326021,"downloads":194572,"collections":643,"likes":446,"comments":102,"user_id":4664461,"user":"lukasbieri","userImageURL":"https://cdn.pixabay.com/user/2017/02/26/12-31-50-780_250x250.jpg"}]}
""";
